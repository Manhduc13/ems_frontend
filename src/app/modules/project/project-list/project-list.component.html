<div class="w-full px-4 bg-gray-800 min-h-screen">
    <!-- Search form -->
    <div class="action py-4 flex flex-row justify-between items-center">
        <form [formGroup]="searchForm" class="flex relative rounded-md w-full max-w-xl" (ngSubmit)="search()">
            <input type="text" formControlName="keyword" placeholder="Enter keyword"
                class="w-full p-2 rounded-md border border-gray-300 placeholder-gray-500 text-white" />
            <button type="submit"
                class="inline-flex items-center gap-2 bg-blue-500 hover:bg-blue-700 text-white text-lg font-semibold px-6">
                Search
            </button>
            <button type="button" (click)="reset()"
                class="inline-flex items-center gap-2 bg-slate-500 hover:bg-slate-700 text-white text-lg font-semibold px-6 rounded-r-md">
                Reset
            </button>
        </form>

        <div class="flex flex-row space-x-3">
            <button class="bg-orange-600 hover:bg-orange-700 text-white font-medium rounded-lg transition-colors p-2"
                (click)="generateReport()">
                Generate Report
            </button>

            <button class="bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors p-2"
                (click)="toCreateForm()">
                New Project
            </button>
        </div>
    </div>
    <!-- Table -->
    <table class="min-w-full divide-y divide-gray-200 overflow-x-auto">
        <thead class="bg-gray-700">
            <tr class="*:px-6 *:py-3 *:text-left *:text-xs *:font-medium *:text-white *:uppercase *:tracking-wider">
                <th *ngFor="let column of columns">{{column}}</th>
            </tr>
        </thead>
        <tbody class=" divide-y divide-gray-200 bg-gray-600">
            <tr *ngFor="let project of projects; let i = index" class="*:px-6 *:py-4 *:whitespace-nowrap *:text-white">
                <td>{{ page * size + i + 1 }}</td>
                <td>{{ project.name }}</td>
                <td>{{ project.startDate }}</td>
                <td>{{ project.budget }}</td>
                <td>
                    <span class="px-2.5 py-2 inline-flex rounded-full text-white lowercase" [ngClass]="{
                            'bg-gray-500': project.status === 'PLANNED',
                            'bg-yellow-500': project.status === 'IN_PROGRESS',
                            'bg-green-500': project.status === 'COMPLETED',
                            'bg-blue-500': project.status === 'ON_HOLD',
                            'bg-red-500': project.status === 'CANCELLED'
                        }">
                        {{ project.status.replace('_', ' ') }}
                    </span>
                </td>
                <td class="space-x-3">
                    <i class="fas fa-eye text-green-500 hover:text-green-700" (click)="viewDetail(project)"></i>
                    <i class="fas fa-edit text-blue-600 hover:text-blue-900" (click)="toEditForm(project)"></i>
                    <i class="fas fa-trash text-red-600 hover:text-red-900" (click)="delete(project.id)"></i>
                </td>
            </tr>
        </tbody>
    </table>
    <!-- Paginantion -->
    <div class="pagination-controls">
        <button (click)="changePage(0)" [disabled]="page === 0">
            <i class="fa-solid fa-angles-left"></i>
        </button>
        <button (click)="changePage(page - 1)" [disabled]="page === 0">
            <i class="fa-solid fa-angle-left"></i>
        </button>

        <ng-container *ngFor="let p of [].constructor(pageInfo?.totalPages); let i = index">
            <button (click)="changePage(i)" [class.active]="page === i">{{ i + 1 }}</button>
        </ng-container>

        <button (click)="changePage(page + 1)" [disabled]="page === pageInfo?.totalPages - 1">
            <i class="fa-solid fa-angle-right"></i>
        </button>
        <button (click)="changePage(pageInfo?.totalPages - 1)" [disabled]="page === pageInfo?.totalPages - 1">
            <i class="fa-solid fa-angles-right"></i>
        </button>

        <label class="text-white ml-10">Page size: </label>
        <select (change)="changePageSize($event)" class="bg-gray-800 text-white border border-gray-300 rounded-md">
            <option [value]="5" selected>5</option>
            <option [value]="10">10</option>
            <option [value]="20">20</option>
        </select>
    </div>

    <!-- Create/Update -->
    <div *ngIf="showCreateUpdateForm" class="mt-6" #createUpdateForm>
        <app-project-create-update [project]="selectedProject" (close)="closeForm()" (refresh)="getAll()">
        </app-project-create-update>
    </div>
    <!--View Employee Detail -->
    <div *ngIf="showDetailPage" class="mt-6" #detailForm>
        <app-project-detail [project]="selectedProject" (close)="closeDetailPage()" (refresh)="getAll()">
        </app-project-detail>
    </div>
</div>